{"version":3,"file":"index.umd.js","sources":["../src/modal.js","../src/progress.js","../node_modules/tinybar/dist/index.m.js","../src/inertia.js","../src/should-intercept.js"],"sourcesContent":["export default {\n  modal: null,\n  listener: null,\n\n  show(html) {\n    let page = document.createElement('html')\n    page.innerHTML = html\n    page.querySelectorAll('a').forEach(a => a.setAttribute('target', '_top'))\n\n    this.modal = document.createElement('div')\n    this.modal.style.position = 'fixed'\n    this.modal.style.width = '100vw'\n    this.modal.style.height = '100vh'\n    this.modal.style.padding = '50px'\n    this.modal.style.backgroundColor = 'rgba(0, 0, 0, .6)'\n    this.modal.style.zIndex = 200000\n    this.modal.addEventListener('click', () => this.hide())\n\n    let iframe = document.createElement('iframe')\n    iframe.style.backgroundColor = 'white'\n    iframe.style.borderRadius = '5px'\n    iframe.style.width = '100%'\n    iframe.style.height = '100%'\n    this.modal.appendChild(iframe)\n\n    document.body.prepend(this.modal)\n    document.body.style.overflow = 'hidden'\n    iframe.contentWindow.document.open()\n    iframe.contentWindow.document.write(page.outerHTML)\n    iframe.contentWindow.document.close()\n\n    this.listener = this.hideOnEscape.bind(this)\n    document.addEventListener('keydown', this.listener)\n  },\n\n  hide() {\n    this.modal.outerHTML = ''\n    this.modal = null\n    document.body.style.overflow = 'visible'\n    document.removeEventListener('keydown', this.listener)\n  },\n\n  hideOnEscape(event) {\n    if (event.keyCode === 27) {\n      this.hide()\n    }\n  },\n}\n","import Tinybar from 'tinybar'\n\nconst tinybar = new Tinybar()\n\nexport default {\n  delay: null,\n  loading: false,\n\n  start() {\n    clearTimeout(this.delay)\n\n    this.delay = setTimeout(() => {\n      this.loading = true\n      tinybar.go(10)\n    }, 250)\n  },\n\n  increment() {\n    if (this.loading) {\n      tinybar.go(50)\n    }\n  },\n\n  stop() {\n    clearTimeout(this.delay)\n\n    if (this.loading) {\n      tinybar.go(100)\n      this.loading = false\n    }\n  },\n}\n","export default function(t){var e,i,d;return{go:function(n){d||(e=document.createElement(\"div\"),i=document.createElement(\"div\"),t?e.id=t:(e.style=\"background:#e2e8f0;height:2px;width:100%;position:fixed;left:0;right:0;top:0;transition:height .3s;z-index:10000\",i.style=\"background:#90cdf4;height:100%;width:0;transition:width .2s ease-out\"),e.addEventListener(\"transitionend\",function(t){var i=t.target;i===e&&(d=!document.body.removeChild(i))}),e.appendChild(i),d=document.body.appendChild(e)),n>0&&(i.style.width=n+\"%\"),n>=100&&(i.style.width=\"100%\",e.style.height=0)}}}\n//# sourceMappingURL=index.m.js.map\n","import Modal from './modal'\nimport Progress from './progress'\n\nexport default {\n  resolveComponent: null,\n  updatePage: null,\n  version: null,\n  visitId: null,\n  abortController: null,\n  page: null,\n\n  init({ initialPage, resolveComponent, updatePage }) {\n    this.resolveComponent = resolveComponent\n    this.updatePage = updatePage\n\n    if (window.history.state && this.navigationType() === 'back_forward') {\n      this.setPage(window.history.state)\n    } else if (window.sessionStorage.getItem('inertia.hardVisit')) {\n      window.sessionStorage.removeItem('inertia.hardVisit')\n      this.setPage(initialPage, { preserveState: true })\n    } else {\n      initialPage.url += window.location.hash\n      this.setPage(initialPage)\n    }\n\n    window.addEventListener('popstate', this.restoreState.bind(this))\n  },\n\n  navigationType() {\n    if (window.performance && window.performance.getEntriesByType('navigation').length) {\n      return window.performance.getEntriesByType('navigation')[0].type\n    }\n  },\n\n  isInertiaResponse(response) {\n    return response && response.headers.has('x-inertia')\n  },\n\n  hasBody(method) {\n    return ['GET', 'HEAD'].indexOf(method.toUpperCase()) === -1\n  },\n\n  getCookieValue(name) {\n    let match = document.cookie.match(new RegExp('(^|;\\\\s*)(' + name + ')=([^;]*)'))\n    return match ? decodeURIComponent(match[3]) : null\n  },\n\n  cancelActiveVisits() {\n    if (this.abortController) {\n      this.abortController.abort()\n    }\n\n    this.abortController = new AbortController()\n  },\n\n  createVisitId() {\n    this.visitId = {}\n    return this.visitId\n  },\n\n  visit(url, { method = 'get', data = {}, replace = false, preserveScroll = false, preserveState = false, only = [] } = {}) {\n    Progress.start()\n    this.cancelActiveVisits()\n    let visitId = this.createVisitId()\n\n    return window.fetch(url.toString(), {\n      method: method.toLowerCase(),\n      ...this.hasBody(method) ? { body: JSON.stringify(data) } : {},\n      signal: this.abortController.signal,\n      credentials: 'include',\n      headers: {\n        'Content-Type': 'application/json;charset=UTF-8',\n        Accept: 'text/html, application/xhtml+xml',\n        'X-Requested-With': 'XMLHttpRequest',\n        'X-Xsrf-Token': this.getCookieValue('XSRF-TOKEN'),\n        'X-Inertia': true,\n        ...(only.length ? {\n          'X-Inertia-Partial-Component': this.page.component,\n          'X-Inertia-Partial-Data': only.join(','),\n        } : {}),\n        ...(this.version ? { 'X-Inertia-Version': this.version } : {}),\n      },\n    }).then(response => {\n      if (response.status === 409 && response.headers.has('x-inertia-location')) {\n        Progress.stop()\n        return this.hardVisit(true, response.headers.get('x-inertia-location'))\n      } else if (this.isInertiaResponse(response)) {\n        return response.json()\n      } else {\n        response.text().then(data => {\n          Progress.stop()\n          Modal.show(data)\n        })\n      }\n    }).catch(error => {\n      if (error.name === 'AbortError') {\n        return\n      } else {\n        return Promise.reject(error)\n      }\n    }).then(page => {\n      if (page) {\n        if (only.length) {\n          page.props = { ...this.page.props, ...page.props }\n        }\n\n        return this.setPage(page, { visitId, replace, preserveScroll, preserveState })\n      }\n    })\n  },\n\n  hardVisit(replace, url) {\n    window.sessionStorage.setItem('inertia.hardVisit', true)\n\n    if (replace) {\n      window.location.replace(url)\n    } else {\n      window.location.href = url\n    }\n  },\n\n  setPage(page, { visitId = this.createVisitId(), replace = false, preserveScroll = false, preserveState = false } = {}) {\n    this.page = page\n    Progress.increment()\n    return Promise.resolve(this.resolveComponent(page.component)).then(component => {\n      if (visitId === this.visitId) {\n        this.version = page.version\n        this.setState(page, replace, preserveState)\n        this.updatePage(component, page.props, { preserveState })\n        this.setScroll(preserveScroll)\n        Progress.stop()\n      }\n    })\n  },\n\n  setScroll(preserveScroll) {\n    if (!preserveScroll) {\n      document.querySelectorAll('html,body,[scroll-region]')\n        .forEach(region => region.scrollTo(0, 0))\n    }\n  },\n\n  setState(page, replace = false, preserveState = false) {\n    if (replace || page.url === `${window.location.pathname}${window.location.search}`) {\n      window.history.replaceState({\n        ...{ cache: preserveState && window.history.state ? window.history.state.cache : {} },\n        ...page,\n      }, '', page.url)\n    } else {\n      window.history.pushState({\n        cache: {},\n        ...page,\n      }, '', page.url)\n    }\n  },\n\n  restoreState(event) {\n    if (event.state) {\n      this.setPage(event.state)\n    }\n  },\n\n  replace(url, options = {}) {\n    return this.visit(url, { preserveState: true, ...options, replace: true })\n  },\n\n  reload(options = {}) {\n    return this.replace(window.location.href, options)\n  },\n\n  post(url, data = {}, options = {}) {\n    return this.visit(url, { preserveState: true, ...options, method: 'post', data })\n  },\n\n  put(url, data = {}, options = {}) {\n    return this.visit(url, { preserveState: true, ...options, method: 'put', data })\n  },\n\n  patch(url, data = {}, options = {}) {\n    return this.visit(url, { preserveState: true, ...options, method: 'patch', data })\n  },\n\n  delete(url, options = {}) {\n    return this.visit(url, { ...options, method: 'delete' })\n  },\n\n  remember(data, key = 'default') {\n    let newState = { ...window.history.state }\n    newState.cache = newState.cache || {}\n    newState.cache[key] = data\n    this.setState(newState)\n  },\n\n  restore(key = 'default') {\n    if (window.history.state.cache && window.history.state.cache[key]) {\n      return window.history.state.cache[key]\n    }\n  },\n}\n","export default function shouldIntercept(event) {\n  return !(\n    (event.target && event.target.isContentEditable)\n    || event.defaultPrevented\n    || event.which > 1\n    || event.altKey\n    || event.ctrlKey\n    || event.metaKey\n    || event.shiftKey\n  )\n}\n"],"names":["modal","listener","show","html","page","document","createElement","innerHTML","querySelectorAll","forEach","a","setAttribute","style","position","width","height","padding","backgroundColor","zIndex","addEventListener","this","hide","iframe","borderRadius","appendChild","body","prepend","overflow","contentWindow","open","write","outerHTML","close","hideOnEscape","bind","removeEventListener","event","keyCode","tinybar","t","e","i","d","go","n","target","removeChild","delay","loading","start","clearTimeout","setTimeout","increment","stop","resolveComponent","updatePage","version","visitId","abortController","init","ref","window","history","state","navigationType","setPage","sessionStorage","getItem","removeItem","initialPage","preserveState","url","location","hash","restoreState","performance","getEntriesByType","length","type","isInertiaResponse","response","headers","has","hasBody","method","indexOf","toUpperCase","getCookieValue","name","match","cookie","RegExp","decodeURIComponent","cancelActiveVisits","abort","AbortController","createVisitId","visit","Progress","fetch","toString","Object","toLowerCase","JSON","stringify","data","signal","credentials","Accept","only","component","join","then","status","hardVisit","get","json","text","Modal","catch","error","Promise","reject","props","replace","preserveScroll","setItem","href","resolve","setState","setScroll","region","scrollTo","replaceState","cache","pushState","options","reload","post","put","patch","delete","remember","key","newState","restore","isContentEditable","defaultPrevented","which","altKey","ctrlKey","metaKey","shiftKey"],"mappings":"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"}